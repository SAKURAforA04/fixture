@model IEnumerable<Fixture02.Models.Employee>

@using PagedList
@using PagedList.Mvc
@using Fixture02.Models;

@{
    Layout = "~/Views/Shared/FixtureMaster.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<body>

    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span3">
                <button class="btn" type="button"> @Html.ActionLink("新增", "Create")</button>
            </div>

            @using (Html.BeginForm("EmployeeIndex", "Employees", FormMethod.Get))
            {
                <p>员工姓名:@Html.TextBox("employeeName", ViewBag.employeeName as string)</p>
                <p>员工权限:@Html.TextBox("userLevel", ViewBag.userLevel as string)</p>
                <p>员工部门:@Html.TextBox("workcellID", ViewBag.workcellID as string)</p>

                <input type="submit" value="查询" />
            }

        </div>
    </div>



    <table class="table">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.EmployeeID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.EmployeeName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Email)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.UserLevel)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Workcell.WorkcellName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Job)
            </th>
            <th></th>
        </tr>

        @{
            List<Employee> list = (List<Employee>)Session["forgets"];
            if (list != null)
            {
                foreach (var emp in list)
                {
                    ViewBag.workcellId = Session["workcellId"];
                    if (emp.WorkcellID == ViewBag.workcellId)
                    {
                        var id = emp.EmployeeID;
                    <tr>
                        <td>
                            @emp.EmployeeName
                        </td>
                        <td>
                            @emp.Email
                        </td>
                        <td>
                            @emp.UserLevel
                        </td>
                        <td>
                            @emp.Workcell.WorkcellName
                        </td>
                        <td>
                            @emp.Job
                        </td>
                        <td>
                            <font color="#FF0000">密码错误</font> |
                            @Html.ActionLink("重置", "passwordReset", new { id = emp.EmployeeID })
                        </td>
                    </tr>
                        }
                    }
                }
            }

        @foreach (var item in Model)
        {
            ViewBag.workcellId = Session["workcellId"];
            if (item.WorkcellID == ViewBag.workcellId)
            {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.EmployeeID)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.EmployeeName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UserLevel)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Workcell.WorkcellName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Job)
        </td>
        <td>
            @Html.ActionLink("编辑", "Edit", new { id = item.EmployeeID }) |
            @Html.ActionLink("详情", "Details", new { id = item.EmployeeID }) |
            @Html.ActionLink("删除", "Delete", new { id = item.EmployeeID })
        </td>
    </tr>
            }
        }

    </table>
    @*@Html.PagedListPager((IPagedList)Model, page => Url.Action("EmployeeIndex", new { page  }))*@
    @Html.PagedListPager((IPagedList)Model, page => Url.Action("EmployeeIndex", new { page, employeeName = ViewBag.employeeName, userLevel = ViewBag.userLevel, workcellID = ViewBag.workcellID }))
    
    
</body>
</html>
